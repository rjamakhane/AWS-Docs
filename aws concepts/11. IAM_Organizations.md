# 🏢 AWS Organizations – Deep Dive Notes

> **File:** IAM_Organizations.md  
> **Purpose:** Understand AWS Organizations, multi-account management, Service Control Policies (SCPs), and exam-level details.

---

## 🧩 1. Overview

**AWS Organizations** enables centralized management of **multiple AWS accounts** under one management account.  
It helps enterprises manage permissions, billing, and compliance across environments (Dev, Test, Prod, Sandbox).

| Feature | Description |
|----------|--------------|
| **Root** | The top-level container for all accounts |
| **Organizational Units (OUs)** | Logical groupings of accounts for policy inheritance |
| **Management Account** | The primary account that controls the organization |
| **Member Accounts** | Accounts invited or created within the organization |
| **Service Control Policies (SCPs)** | Policies applied at OU or account level to set permission boundaries |

---

## 🧱 2. AWS Organization Structure

```
[Root]
 ├── [OU: Development]
 │     ├── Account: Dev-1
 │     └── Account: Dev-2
 ├── [OU: Production]
 │     ├── Account: Prod-1
 │     └── Account: Prod-2
 └── [OU: Security]
       └── Account: Sec-Logging
```

✅ **Policies (SCPs)** can be attached at the **root**, **OU**, or **account** level, and apply downward in the hierarchy.

---

## 🔐 3. Service Control Policies (SCPs)

SCPs define the **maximum available permissions** for accounts in an organization.  
They **do not grant permissions directly** — they only **restrict** what IAM policies can allow.

### 🧩 Example SCP: Deny EC2 Instance Deletion
```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Deny",
      "Action": "ec2:TerminateInstances",
      "Resource": "*"
    }
  ]
}
```

### 🔹 SCP Key Points
- Applied **organization-wide** or per **OU/account**.
- Must be **enabled in AWS Organizations** to take effect.
- **Affect all users/roles**, including root users in member accounts.
- Combine with **IAM policies** for effective control.

---

## ⚖️ 4. SCPs vs IAM Policies

| Feature | Service Control Policy (SCP) | IAM Policy |
|----------|-------------------------------|-------------|
| **Scope** | Organization, OU, or Account | IAM User, Group, or Role |
| **Purpose** | Restrict maximum allowed permissions | Grant specific permissions |
| **Can Grant Access?** | ❌ No | ✅ Yes |
| **Affects Root User?** | ✅ Yes | ❌ No |
| **Default Behavior** | Full access (unless restricted) | No access (unless granted) |
| **Evaluation Logic** | IAM policy must *allow* and SCP must *not deny* | Evaluates per principal only |
| **Example Use Case** | Restrict all accounts from disabling CloudTrail | Allow S3 read/write for developers |

---

## 🧭 5. Common Use Cases

| Scenario | Example |
|-----------|----------|
| **Centralized Billing** | Combine all AWS accounts for unified cost view |
| **Multi-Environment Setup** | Separate Dev, Test, and Prod under different OUs |
| **Security Controls** | Enforce restrictions like “No public S3 buckets” |
| **Regulatory Compliance** | Apply SCPs to ensure audit and logging policies are always enabled |
| **Delegated Administration** | Grant OU-level admins limited control over specific accounts |

---

## 💡 6. Best Practices

| Best Practice | Description |
|----------------|-------------|
| **Enable SCPs Early** | Define global security boundaries upfront |
| **Use OUs for Logical Segregation** | Separate workloads by function or environment |
| **Apply Deny Policies Cautiously** | Avoid locking out required services |
| **Centralize Logging and Auditing** | Use a dedicated “Security” account for CloudTrail, Config, GuardDuty |
| **Least Privilege Principle** | Combine IAM policies + SCPs for tight control |
| **Tag Accounts Consistently** | Helps automate billing and compliance reports |

---

## 🧱 7. Example: Multi-Account Strategy

```
Root
 ├── OU: Dev
 │     └── Accounts: Dev1, Dev2
 ├── OU: Prod
 │     └── Accounts: Prod1, Prod2
 └── OU: Security
       ├── Central Logging
       ├── Security Tools
       └── Audit
```

Each OU can inherit **SCPs**, enabling layered access control while maintaining flexibility.

---

## 🧠 8. Real-World Example

A financial organization uses:
- **OU: Prod** → SCP restricts disabling CloudTrail and Config  
- **OU: Dev** → SCP denies creation of high-cost EC2 instance types  
- **OU: Security** → SCP denies deletion of IAM roles or S3 logs  

✅ This enforces both **security and cost management** organization-wide.

---

## 🎯 9. Certification Q&A

**Q1.** What is the main function of Service Control Policies?  
**A:** SCPs define *maximum permissions* an account can have, restricting IAM policies.

**Q2.** Do SCPs apply to the management account?  
**A:** ❌ No, they only apply to member accounts.

**Q3.** Can SCPs directly grant access to AWS resources?  
**A:** ❌ No, they only restrict permissions.

**Q4.** What happens if an action is denied in SCP but allowed in IAM policy?  
**A:** ❌ The action is denied — SCPs act as a permission boundary.

---

## 🏁 10. Key Takeaways

- **AWS Organizations** centralizes multi-account management.  
- **SCPs** = top-level permission boundaries.  
- IAM policies must allow, and SCPs must *not deny* for access to succeed.  
- Organize accounts into **OUs** for structure and policy inheritance.  
- Combine SCPs + IAM + CloudTrail for governance and compliance.

---

🏢 *End of Document*  
**File:** `IAM_Organizations.md`
